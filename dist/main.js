!function(e,o){e&&!e.getElementById("livereloadscript")&&((o=e.createElement("script")).async=1,o.src="//"+(self.location.host||"localhost").split(":")[0]+":35730/livereload.js?snipver=1",o.id="livereloadscript",e.getElementsByTagName("head")[0].appendChild(o))}(self.document),function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";function e(e){return e.hauteur}function o(e){return e.z_min-e.hauteur}const t=document.getElementById("viewerDiv"),i={coord:new itowns.Coordinates("EPSG:4326",4.83518,45.7613),range:3e3,tilt:60};let n=new itowns.GlobeView(t,i);const r=function(e,o,t,i,n){const r=new itowns.WMTSSource({url:e,crs:o,name:t,tileMatrixSet:i,format:n});return new itowns.ColorLayer("Ortho",{source:r})}("http://wxs.ign.fr/3ht7xcw6f7nciopo16etuqp2/geoportail/wmts","EPSG:3857","ORTHOIMAGERY.ORTHOPHOTOS","PM","image/jpeg");n.addLayer(r);const l=function(e,o,t,i,n){const r=new itowns.WMTSSource({url:e,crs:o,name:t,tileMatrixSet:i,format:n,tileMatrixSetLimits:{11:{minTileRow:442,maxTileRow:1267,minTileCol:1344,maxTileCol:2683},12:{minTileRow:885,maxTileRow:2343,minTileCol:3978,maxTileCol:5126},13:{minTileRow:1770,maxTileRow:4687,minTileCol:7957,maxTileCol:10253},14:{minTileRow:3540,maxTileRow:9375,minTileCol:15914,maxTileCol:20507}}});return new itowns.ElevationLayer("MNT_WORLD",{source:r})}("http://wxs.ign.fr/3ht7xcw6f7nciopo16etuqp2/geoportail/wmts","EPSG:4326","ELEVATION.ELEVATIONGRIDCOVERAGE.HIGHRES","WGS84G","image/x-bil;bits=32");n.addLayer(l);const s=function(t,i,n,r,l,s){const c=new itowns.WFSSource({url:t,typeName:i,crs:n,extent:l});let a={},d={};return{layer:new itowns.FeatureGeometryLayer("Buildings",{source:c,zoom:{min:r},style:new itowns.Style({fill:{color:function(e){const o=e.id;let t="rgb(255, 255, 255)";return console.log(e.id),console.log(d),console.log(Object.keys(d).includes(o)),console.log(t),new itowns.THREE.Color(t)},base_altitude:o,extrusion_height:e}}),onMeshCreated:function(e){e.children.forEach((e=>{let o=e.children[0].children[0].children[0].feature.geometries,t=0;o.map((o=>{t++;let i=o.properties.id;d[i]=o.properties,t%70==0&&(a[i]={id:i,batiMesh:e.children[0].children[0].children[0],position:{x:(o.properties.bbox[0]+o.properties.bbox[2])/2,y:(o.properties.bbox[1]+o.properties.bbox[3])/2,z:o.properties.z_min}})}))}))}}),coords:a,bat:d}}("http://wxs.ign.fr/3ht7xcw6f7nciopo16etuqp2/geoportail/wfs?","BDTOPO_BDD_WLD_WGS84G:bati_indifferencie","EPSG:4326",14,{west:4.77244,east:4.87408,south:45.71694,north:45.80481}),c=s.layer,a=s.coords;console.log("test"),console.log(a),n.addLayer(c),n.addEventListener(itowns.GLOBE_VIEW_EVENTS.GLOBE_INITIALIZED,(function(){let e;console.info("Globe initialized"),Object.entries(a).forEach((function([o,t]){e=function(e,o,t,i){const n=itowns.THREE,r=new n.CylinderGeometry(0,10,60,8),l=new n.MeshBasicMaterial({color:16761035}),s=new n.Mesh(r,l),c=i.controls.getLookAtCoordinate();return c.altitude+=30,c.x=e,c.y=o,s.position.copy(c.as(i.referenceCrs)),s.rotateX(Math.PI/2),s.updateMatrixWorld(),i.scene.add(s),i.mesh=s,i.notifyChange(),s}(t.position.x,t.position.y,t.position.z,n),a[o].mesh=e,e.material.color.set("rgb(0, 255, 0)"),console.log(a[o].batiMesh)}))}))}));
//# sourceMappingURL=main.js.map
